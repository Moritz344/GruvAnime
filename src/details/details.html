<app-topbar></app-topbar>
@if (data && !loading) {
  <div class="container">
    <div class="main-container">
      <div class="anime-card">
        <div class="info">
          <h1 class="title">{{ data.title }}</h1>
          <h2 *ngIf="data.title_japanese">{{ data.title_japanese }}</h2>
          <div class="row-1">
          <span class="year" *ngIf="data.year">
            {{ data.year }}
          </span>
          <span class="status" *ngIf="data.status">
            {{ data.status }}
          </span>
          </div>
          <div class="genre-container">
          <div class="row-2">
            @for (genre of data.genres; track $index) {
              <span class="genre">{{ genre.name }}</span>
            }
          </div>
          </div>
            <p class="synopsis">{{ data.synopsis }}</p>
            <p></p>
        </div>
        <img draggable="false" [src]="data.images.jpg.large_image_url">
        <div class="anime-card-bottom-info">
            <span class="rank">Rank #{{ data.rank }}</span>
            <span class="score">Score {{ data.score }}</span>
            <span class="fav">Favorites {{ data.favorites }}</span>
            <span class="pop">Popularity #{{ data.popularity }}</span>
        </div>
      </div>
    </div>

    <br>
      @if (animeCharData && animeCharData.length > 0) {

        <h1 class="char-title">Characters </h1>
        <br> <br>
        <div class="char-container">
          @for (char of animeCharData; track $index) {
            <div class="char" *ngIf="char.role == 'Main' ">
             <img width="220" height="360" [src]="char.character.images.jpg.image_url">
             <div class="char-info">
              <span><a [href]="char.character.url">{{ char.character.name }}</a></span>
              <span>{{ char.role }}</span>
             </div>
            </div>
          }
        </div>

  }
      </div>


}

  <h1 class="review-title" *ngIf="reviewData && reviewData.length > 0">Reviews ({{ reviewData.length }}) </h1>
  <div class="review-container-top" *ngIf="reviewData && reviewData.length > 0">
  <div class="review-container">
      @for (d of reviewData; track $index) {
          <div class="review">
            <img [src]="d.user.images.jpg.image_url" width="50" height="60">
            <a [href]="d.user.url" target="_blank" class="user">{{ d.user.username }}</a> <br>
            <div class="tag-container">
            @for (t of d.tags; track $index) {
              <span class="tag">{{ t }}</span>
            }
            </div>
            @if (showMoreText && currentSelectedReview == d) {
              <p>{{ d.review }}</p>
            }@else {
                <p>{{ d.shortReview }}</p>
            }
   </div>
      <div class="review-options">
        <button class="review-option-read" (click)="onReadMore($index)">
        @if (showMoreText) {
            Read less
        }@else {
            Read More
        }
        </button>
      </div>
    }

  </div>

  @if (loading) {
    <div class="loader-container">
      <div class="loader"></div>
      Give it some time.
    </div>
  }

