<app-topbar></app-topbar>
@if (data && !loading) {
  <div class="container">
    <div class="main-container">
      <div class="anime-card">
        <div [ngClass]="{ 'info': !isMobile, 'info-mobile': isMobile }">
          <div [ngClass]="{ 'title-container': !isMobile, 'title-container-mobile': isMobile }">
            <h1 class="title">{{ data.title_english }} </h1>
            <h2 >{{ data.title_japanese }}</h2>
          </div>
          <div [ngClass]="{ 'row-1': !isMobile, 'row-1-mobile': isMobile }">
            <span class="badge" *ngIf="data.year">
              {{ data.year }}
            </span>
            <span class="badge" *ngIf="data.status">
              {{ data.status }}
            </span>
            <span class="badge" *ngIf="data.episodes">
              Episodes: {{ data.episodes }}
            </span>
            </div>
            <div [ngClass]="{ 'genre-container': !isMobile, 'genre-container-mobile': isMobile }" *ngIf="data.genres.length > 1">
              @for (genre of data.genres; track $index) {
                <span class="genre" >{{ genre.name }}</span>
              }
          </div>
        </div>
        <img draggable="false" [src]="data.images.jpg.large_image_url">
      </div>
    </div>
      <h1 [ngClass]="{ 'desc-title': !isMobile, 'desc-title-mobile': isMobile }">Description</h1>
      <div [ngClass]="{ 'desc-container': !isMobile, 'desc-container-mobile': isMobile }">
        <p>{{ data.synopsis }}</p>
      </div>
      <div [ngClass]="{ 'info-container': !isMobile, 'info-container-mobile': isMobile }">
        <h1 [ngClass]="{ 'info-title': !isMobile, 'info-title-mobile': isMobile }">Information</h1>
        <table [ngClass]="{ 'info-table': !isMobile, 'info-table-mobile': isMobile }">
          <tr *ngIf="data && data.type">
            <td><span>Type</span></td>
            <td><span style="float: right" >{{ data.type }}</span></td>
          </tr>
          <tr *ngIf="data && data.episodes">
            <td><span>Episodes</span></td>
            <td><span style="float: right" >{{ data.episodes }}</span></td>
          </tr>
          <tr *ngIf="data && data.status">
            <td><span>Status</span></td>
            <td><span style="float: right" >{{ data.status }}</span></td>
          </tr>
          <tr *ngIf="data && data.season">
            <td><span>Season</span></td>
            <td><span style="float: right" >{{ data.season }}</span></td>
          </tr>
          <tr *ngIf="data.studios && data.studios.length > 1">
            <td><span>Studio</span></td>
            <td><span style="float: right" >{{ data.studios[0]["name"] }}</span></td>
          </tr>
          <tr *ngIf="data.duration && data.duration != 'Unknown'">
            <td><span>Duration</span></td>
            <td><span style="float: right" >{{ data.duration }}</span></td>
          </tr>
        </table>
      </div>

      <div [ngClass]="{ 'stat-container': !isMobile, 'stat-container-mobile': isMobile }" *ngIf="data.score || data.popularity || data.members">
        <h1 [ngClass]="{ 'info-title': !isMobile, 'stat-title-mobile': isMobile }">Statistics</h1>     
        <table [ngClass]="{ 'stat-table': !isMobile, 'stat-table-mobile': isMobile }">
          <tr *ngIf="data.score">
            <td><img src="score.png" class="score-img" width="20" height="20" ><span>Score</span></td>
            <td><span style="float: right">{{ data.score }}</span></td>
          </tr>
          <tr *ngIf="data.popularity">
            <td><img src="arrow_up.svg" class="pop-img" width="30" height="30"><span>Popularity</span></td>
            <td><span style="float: right" >{{ data.popularity  }}</span></td>
          </tr>
          <tr *ngIf="data.members">
            <td><img src="user.svg" class="members-img" width="30" height="30" ><span>Members</span></td>
            <td><span style="float: right">{{ data.members }}</span></td>
          </tr>
        </table>
      </div>


      @if (animeCharData && animeCharData.length > 0) {
        <h1 [ngClass]="{ 'char-title': !isMobile,'char-title-mobile': isMobile}">Characters ({{ animeCharData.length }} in total) </h1>
        <div [ngClass]="{ 'char-container': !isMobile, 'char-container-mobile': isMobile }">
          @for (char of animeCharDataLimited; track $index) {
            <div class="char" *ngIf="char.role == 'Main' ">
             <img width="220" height="360" [src]="char.character.images.jpg.image_url">
             <div class="char-info">
              <span><a [href]="char.character.url" target="_blank">{{ char.character.name }}</a></span>
              <span>{{ char.role }}</span>
             </div>
            </div>
          }
        </div>
      }

      @if (relationsDataMore && relationsDataMore.length > 1) {
        <h1 [ngClass]="{ 'rel-title': !isMobile,'rel-title-mobile': isMobile}">Relations</h1>
        <div [ngClass]="{ 'rel-container': !isMobile, 'rel-container-mobile': isMobile }">
          @for (relation of relationsDataMore; track $index) {
            <app-anime-block [data]="relation" [isAnime]="true"></app-anime-block>
          }
        </div>
      }
      @if (loadingRelations){
        <div class="loader-relations">
          <h1 [ngClass]="{ 'rel-title': !isMobile,'rel-title-mobile': isMobile}">Loading Relations ...</h1>
          <div style="margin-left: 100px" class="loader"></div>
        </div>
      }



      
    <h1 [ngClass]="{'review-title': !isMobile,'review-title-mobile': isMobile}" *ngIf="reviewData && reviewData.length > 0">Reviews ({{ reviewData.length }}) </h1>
    <div [ngClass]="{ 'review-container': !isMobile, 'review-container-mobile': isMobile }">
      @for ( review of reviewData; track $index) {
        <app-review [data]="review" ></app-review>
      }
    </div>
    <br><br>
</div>


}
   


  @if (loading) {
    <div class="loader-container">
      <div class="loader"></div>
    </div>
  }

